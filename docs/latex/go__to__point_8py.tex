\hypertarget{go__to__point_8py}{}\doxysection{scripts/go\+\_\+to\+\_\+point.py File Reference}
\label{go__to__point_8py}\index{scripts/go\_to\_point.py@{scripts/go\_to\_point.py}}


Node implementing an aglorhitm to move the robot.  


\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{go__to__point_8py_a36304a9f313b0579f7fc69fa01695524}{go\+\_\+to\+\_\+point.\+clbk\+\_\+odom}} (msg)
\begin{DoxyCompactList}\small\item\em Odometry callback. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_a31ee48e5cae36821049b572a96b7c8be}{go\+\_\+to\+\_\+point.\+change\+\_\+state}} (state)
\begin{DoxyCompactList}\small\item\em Change state. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_ac688bb56fa84763ea2edefc30cae032a}{go\+\_\+to\+\_\+point.\+normalize\+\_\+angle}} (angle)
\begin{DoxyCompactList}\small\item\em Normalize the angle. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_a9c3011a3065fcbefcc1c5ad8c9979669}{go\+\_\+to\+\_\+point.\+fix\+\_\+yaw}} (des\+\_\+pos)
\begin{DoxyCompactList}\small\item\em Fix the yaw angle. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_ac8579665c0fbf665f734476554fac37d}{go\+\_\+to\+\_\+point.\+go\+\_\+straight\+\_\+ahead}} (des\+\_\+pos)
\begin{DoxyCompactList}\small\item\em Function to go straight. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_a4a406386ca62830c19c93949e923f7bd}{go\+\_\+to\+\_\+point.\+fix\+\_\+final\+\_\+yaw}} (des\+\_\+yaw)
\begin{DoxyCompactList}\small\item\em Final fix to yaw angle. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_ac2587220a4ac9c845bc9c5b0b45d5835}{go\+\_\+to\+\_\+point.\+done}} ()
\begin{DoxyCompactList}\small\item\em Function to call when the target is reached or when it\textquotesingle{}s cancelled, it sets to zero the linear and angualar velocity of the robot in order to stop it. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_a2203d17b7e563bee20ed4c988548df45}{go\+\_\+to\+\_\+point.\+go\+\_\+to\+\_\+point}} (goal)
\begin{DoxyCompactList}\small\item\em Function to perform the motion of the robot to reach the goal. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_abfcc6ba47d138b2b8ee0d51109868803}{go\+\_\+to\+\_\+point.\+slider\+Velocity}} (vel)
\begin{DoxyCompactList}\small\item\em Get the velocity from the sliders. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{go__to__point_8py_ab92bd6db1ec323a4d795ed6cb40aebe1}{go\+\_\+to\+\_\+point.\+main}} ()
\begin{DoxyCompactList}\small\item\em Main function of the node. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{go__to__point_8py_a91dbaab25e6080f6b5dbf82cac6ce75c}{go\+\_\+to\+\_\+point.\+position\+\_\+}} = Point()
\begin{DoxyCompactList}\small\item\em Point to store the actual position. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a98ce19d0c843fd1cb438e6630ae107c2}\label{go__to__point_8py_a98ce19d0c843fd1cb438e6630ae107c2}} 
\mbox{\hyperlink{go__to__point_8py_a98ce19d0c843fd1cb438e6630ae107c2}{go\+\_\+to\+\_\+point.\+result}} = rt2\+\_\+assignment1.\+msg.\+Position\+Result()
\begin{DoxyCompactList}\small\item\em Feedback to know the state of the target. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a777e85f1b4d3c81f9e89a3318257eb22}\label{go__to__point_8py_a777e85f1b4d3c81f9e89a3318257eb22}} 
int \mbox{\hyperlink{go__to__point_8py_a777e85f1b4d3c81f9e89a3318257eb22}{go\+\_\+to\+\_\+point.\+lin\+\_\+coef}} = 1
\begin{DoxyCompactList}\small\item\em Initialization of linear velocity obtained from the sliders (1 since it doens\textquotesingle{}t change the default velocity value) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a333f82df9f091269ae05380c2b6e9877}\label{go__to__point_8py_a333f82df9f091269ae05380c2b6e9877}} 
int \mbox{\hyperlink{go__to__point_8py_a333f82df9f091269ae05380c2b6e9877}{go\+\_\+to\+\_\+point.\+ang\+\_\+coef}} = 1
\begin{DoxyCompactList}\small\item\em Initialization of angular velocity obtained from the sliders (1 since it doens\textquotesingle{}t change the default velocity value) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_ae444f19eb2019982432760ace036ce03}\label{go__to__point_8py_ae444f19eb2019982432760ace036ce03}} 
int \mbox{\hyperlink{go__to__point_8py_ae444f19eb2019982432760ace036ce03}{go\+\_\+to\+\_\+point.\+yaw\+\_\+}} = 0
\begin{DoxyCompactList}\small\item\em yaw angle set to 0 as default \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_aa2d0ef255bcf5d5faf9ca2764730fb17}\label{go__to__point_8py_aa2d0ef255bcf5d5faf9ca2764730fb17}} 
int \mbox{\hyperlink{go__to__point_8py_aa2d0ef255bcf5d5faf9ca2764730fb17}{go\+\_\+to\+\_\+point.\+state\+\_\+}} = 0
\begin{DoxyCompactList}\small\item\em state set to 0 as default \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a57b4090d0abcbcf0bfa2bcb9329d3036}\label{go__to__point_8py_a57b4090d0abcbcf0bfa2bcb9329d3036}} 
\mbox{\hyperlink{go__to__point_8py_a57b4090d0abcbcf0bfa2bcb9329d3036}{go\+\_\+to\+\_\+point.\+pub\+\_\+}} = None
\begin{DoxyCompactList}\small\item\em Initialization of variable for the publisher to /cmd\+\_\+vel. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a7315cd3eb4bfee0eb4c2681e9140575e}\label{go__to__point_8py_a7315cd3eb4bfee0eb4c2681e9140575e}} 
\mbox{\hyperlink{go__to__point_8py_a7315cd3eb4bfee0eb4c2681e9140575e}{go\+\_\+to\+\_\+point.\+velocity}} = None
\begin{DoxyCompactList}\small\item\em Initialization of variable for the client to /set\+\_\+velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a67f95834f0959feb3facd17bc7fa2b38}\label{go__to__point_8py_a67f95834f0959feb3facd17bc7fa2b38}} 
int \mbox{\hyperlink{go__to__point_8py_a67f95834f0959feb3facd17bc7fa2b38}{go\+\_\+to\+\_\+point.\+yaw\+\_\+precision\+\_\+}} = math.\+pi / 9
\begin{DoxyCompactList}\small\item\em parameters for control \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_af74ccf49164d0478ca8343e2031d5813}\label{go__to__point_8py_af74ccf49164d0478ca8343e2031d5813}} 
int {\bfseries go\+\_\+to\+\_\+point.\+yaw\+\_\+precision\+\_\+2\+\_\+} = math.\+pi / 90
\item 
\mbox{\Hypertarget{go__to__point_8py_a6a1e4eb20ebd4fce0fc56b0ebfd7a8d5}\label{go__to__point_8py_a6a1e4eb20ebd4fce0fc56b0ebfd7a8d5}} 
float \mbox{\hyperlink{go__to__point_8py_a6a1e4eb20ebd4fce0fc56b0ebfd7a8d5}{go\+\_\+to\+\_\+point.\+dist\+\_\+precision\+\_\+}} = 0.\+1
\begin{DoxyCompactList}\small\item\em maximum distance from the target allowed to consider the target reached \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a524106fc7667a0927951dfd89d52d6a7}\label{go__to__point_8py_a524106fc7667a0927951dfd89d52d6a7}} 
float \mbox{\hyperlink{go__to__point_8py_a524106fc7667a0927951dfd89d52d6a7}{go\+\_\+to\+\_\+point.\+kp\+\_\+a}} = -\/3.\+0
\begin{DoxyCompactList}\small\item\em angular proportional constant \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a7bc498652ca66932e704e738b50c297b}\label{go__to__point_8py_a7bc498652ca66932e704e738b50c297b}} 
float \mbox{\hyperlink{go__to__point_8py_a7bc498652ca66932e704e738b50c297b}{go\+\_\+to\+\_\+point.\+kp\+\_\+d}} = 0.\+2
\begin{DoxyCompactList}\small\item\em linear proportional constant \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_acb4e14986fafe5cb73bb8ad0c178869d}\label{go__to__point_8py_acb4e14986fafe5cb73bb8ad0c178869d}} 
float \mbox{\hyperlink{go__to__point_8py_acb4e14986fafe5cb73bb8ad0c178869d}{go\+\_\+to\+\_\+point.\+ub\+\_\+a}} = 0.\+6
\begin{DoxyCompactList}\small\item\em upper bound angular velocity \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_afecad4058844db05d8321199e25b4498}\label{go__to__point_8py_afecad4058844db05d8321199e25b4498}} 
float \mbox{\hyperlink{go__to__point_8py_afecad4058844db05d8321199e25b4498}{go\+\_\+to\+\_\+point.\+lb\+\_\+a}} = -\/0.\+5
\begin{DoxyCompactList}\small\item\em lower bound linear velocity \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a16c473b9e717200c483d18e66b48152a}\label{go__to__point_8py_a16c473b9e717200c483d18e66b48152a}} 
float \mbox{\hyperlink{go__to__point_8py_a16c473b9e717200c483d18e66b48152a}{go\+\_\+to\+\_\+point.\+ub\+\_\+d}} = 0.\+6
\begin{DoxyCompactList}\small\item\em upper bound linear velocity \end{DoxyCompactList}\item 
\mbox{\Hypertarget{go__to__point_8py_a9af800eec02eb94f70ee4ac6fbea1ecd}\label{go__to__point_8py_a9af800eec02eb94f70ee4ac6fbea1ecd}} 
\mbox{\hyperlink{go__to__point_8py_a9af800eec02eb94f70ee4ac6fbea1ecd}{go\+\_\+to\+\_\+point.\+server}} = None
\begin{DoxyCompactList}\small\item\em action server \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Node implementing an aglorhitm to move the robot. 

\begin{DoxyAuthor}{Author}
Carmine Recchiuto, Alessio Roda 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+2 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
September 2021
\end{DoxyDate}
Subscribes to\+: ~\newline
 /odom

Publishes to\+: ~\newline
 /cmd\+\_\+vel

Client to\+: ~\newline
 /set\+\_\+velocity

Action server\+: ~\newline
 /go\+\_\+to\+\_\+point

It\textquotesingle{}s performed as the node that permits the robot to move\+: it contains all the functions to set the velocity and the orientation of the robot based on the target it has to reach via the Action\+Goal that was sent from the /state\+\_\+machine node. In order to do this, when a new target is generated the robot aligns its orienation, then moves to the target with a velocity that is proportional to the velocity set with the sliders in the user\+\_\+interface notebook interface. Once the target is reached, the node sets the target action as succeded, then waits untill a new target is sent. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{go__to__point_8py_a31ee48e5cae36821049b572a96b7c8be}\label{go__to__point_8py_a31ee48e5cae36821049b572a96b7c8be}} 
\index{go\_to\_point.py@{go\_to\_point.py}!change\_state@{change\_state}}
\index{change\_state@{change\_state}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{change\_state()}{change\_state()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+change\+\_\+state (\begin{DoxyParamCaption}\item[{}]{state }\end{DoxyParamCaption})}



Change state. 


\begin{DoxyParams}{Parameters}
{\em state(int)} & int variable for the new state of the F\+SM\\
\hline
\end{DoxyParams}
Function to change from a state to another in the go\+\_\+to\+\_\+point function \mbox{\Hypertarget{go__to__point_8py_a36304a9f313b0579f7fc69fa01695524}\label{go__to__point_8py_a36304a9f313b0579f7fc69fa01695524}} 
\index{go\_to\_point.py@{go\_to\_point.py}!clbk\_odom@{clbk\_odom}}
\index{clbk\_odom@{clbk\_odom}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{clbk\_odom()}{clbk\_odom()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+clbk\+\_\+odom (\begin{DoxyParamCaption}\item[{}]{msg }\end{DoxyParamCaption})}



Odometry callback. 


\begin{DoxyParams}{Parameters}
{\em msg} & Odometry type message\\
\hline
\end{DoxyParams}
Callback to get the current position of the robot from an /odom message, type Odometry

current posiotion is saved in terms of x, y and z coordinates and w orientation \mbox{\Hypertarget{go__to__point_8py_ac2587220a4ac9c845bc9c5b0b45d5835}\label{go__to__point_8py_ac2587220a4ac9c845bc9c5b0b45d5835}} 
\index{go\_to\_point.py@{go\_to\_point.py}!done@{done}}
\index{done@{done}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{done()}{done()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+done (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Function to call when the target is reached or when it\textquotesingle{}s cancelled, it sets to zero the linear and angualar velocity of the robot in order to stop it. 

\mbox{\Hypertarget{go__to__point_8py_a4a406386ca62830c19c93949e923f7bd}\label{go__to__point_8py_a4a406386ca62830c19c93949e923f7bd}} 
\index{go\_to\_point.py@{go\_to\_point.py}!fix\_final\_yaw@{fix\_final\_yaw}}
\index{fix\_final\_yaw@{fix\_final\_yaw}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{fix\_final\_yaw()}{fix\_final\_yaw()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+fix\+\_\+final\+\_\+yaw (\begin{DoxyParamCaption}\item[{}]{des\+\_\+yaw }\end{DoxyParamCaption})}



Final fix to yaw angle. 


\begin{DoxyParams}{Parameters}
{\em des\+\_\+yaw(float)} & the desired yaw\\
\hline
\end{DoxyParams}
Once the goal\textquotesingle{}s position is acheived the function orients the robot in order to reach the goal \mbox{\Hypertarget{go__to__point_8py_a9c3011a3065fcbefcc1c5ad8c9979669}\label{go__to__point_8py_a9c3011a3065fcbefcc1c5ad8c9979669}} 
\index{go\_to\_point.py@{go\_to\_point.py}!fix\_yaw@{fix\_yaw}}
\index{fix\_yaw@{fix\_yaw}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{fix\_yaw()}{fix\_yaw()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+fix\+\_\+yaw (\begin{DoxyParamCaption}\item[{}]{des\+\_\+pos }\end{DoxyParamCaption})}



Fix the yaw angle. 


\begin{DoxyParams}{Parameters}
{\em des\+\_\+pos(\+Point)} & desired position to reach\\
\hline
\end{DoxyParams}
Function used to orient the robot respect to the target \mbox{\Hypertarget{go__to__point_8py_ac8579665c0fbf665f734476554fac37d}\label{go__to__point_8py_ac8579665c0fbf665f734476554fac37d}} 
\index{go\_to\_point.py@{go\_to\_point.py}!go\_straight\_ahead@{go\_straight\_ahead}}
\index{go\_straight\_ahead@{go\_straight\_ahead}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{go\_straight\_ahead()}{go\_straight\_ahead()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+go\+\_\+straight\+\_\+ahead (\begin{DoxyParamCaption}\item[{}]{des\+\_\+pos }\end{DoxyParamCaption})}



Function to go straight. 


\begin{DoxyParams}{Parameters}
{\em des\+\_\+pos(\+Point)} & the desired position to reach\\
\hline
\end{DoxyParams}
Function to call in case the robot has to go straigth once it is correctly orriented

Set the linear and angular velocity of the robot according to the distance to the target \mbox{\Hypertarget{go__to__point_8py_a2203d17b7e563bee20ed4c988548df45}\label{go__to__point_8py_a2203d17b7e563bee20ed4c988548df45}} 
\index{go\_to\_point.py@{go\_to\_point.py}!go\_to\_point@{go\_to\_point}}
\index{go\_to\_point@{go\_to\_point}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{go\_to\_point()}{go\_to\_point()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+go\+\_\+to\+\_\+point (\begin{DoxyParamCaption}\item[{}]{goal }\end{DoxyParamCaption})}



Function to perform the motion of the robot to reach the goal. 


\begin{DoxyParams}{Parameters}
{\em goal(\+Point)} & the goal to reach \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: a boolean \textquotesingle{}True\textquotesingle{} value to notify that the function has finished
\end{DoxyReturn}
Function that gets the goal position to reach and, based on that, calls the functions to perform the motion of the robot.

It checks if the goal has\textquotesingle{}t been cancelled; in this case it sets the state\+\_\+ variable to 3 in order to terminate the process to move to reach a certain position

It also multiplies the linear and angular velocity values sent from the sliders via Velocity custom service message to the current linear and angular velocity, then publishes the new velocity message to perform the correct motion to reach the goal. \mbox{\Hypertarget{go__to__point_8py_ab92bd6db1ec323a4d795ed6cb40aebe1}\label{go__to__point_8py_ab92bd6db1ec323a4d795ed6cb40aebe1}} 
\index{go\_to\_point.py@{go\_to\_point.py}!main@{main}}
\index{main@{main}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Main function of the node. 

The main function for this script\+: it initializes the publisher, the subscribers and the Simple\+Action\+Server, in particular

creates a publisher on topic /cmd\+\_\+vel to publish the robot\textquotesingle{}s velocity creates a subscriber on topic /odom to get the current position of the robot creates a service on topic /set\+\_\+velocity to get the linear and angular values from the sliders creates an action in order to manage the F\+SM \mbox{\Hypertarget{go__to__point_8py_ac688bb56fa84763ea2edefc30cae032a}\label{go__to__point_8py_ac688bb56fa84763ea2edefc30cae032a}} 
\index{go\_to\_point.py@{go\_to\_point.py}!normalize\_angle@{normalize\_angle}}
\index{normalize\_angle@{normalize\_angle}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{normalize\_angle()}{normalize\_angle()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+normalize\+\_\+angle (\begin{DoxyParamCaption}\item[{}]{angle }\end{DoxyParamCaption})}



Normalize the angle. 


\begin{DoxyParams}{Parameters}
{\em angle(float)} & float varaible for the angle to normalize \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: returns the normalized angle
\end{DoxyReturn}
Function to normalize the angle of the robot \mbox{\Hypertarget{go__to__point_8py_abfcc6ba47d138b2b8ee0d51109868803}\label{go__to__point_8py_abfcc6ba47d138b2b8ee0d51109868803}} 
\index{go\_to\_point.py@{go\_to\_point.py}!sliderVelocity@{sliderVelocity}}
\index{sliderVelocity@{sliderVelocity}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{sliderVelocity()}{sliderVelocity()}}
{\footnotesize\ttfamily def go\+\_\+to\+\_\+point.\+slider\+Velocity (\begin{DoxyParamCaption}\item[{}]{vel }\end{DoxyParamCaption})}



Get the velocity from the sliders. 


\begin{DoxyParams}{Parameters}
{\em (\+Velocity)} & a Velocity custom message\\
\hline
\end{DoxyParams}
Callback to get the linar and angular velocity values sent from the user\+\_\+interface by Velocity custom service message

It saves these values in the global variables lin\+\_\+coef and ang\+\_\+coef 

\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{go__to__point_8py_a91dbaab25e6080f6b5dbf82cac6ce75c}\label{go__to__point_8py_a91dbaab25e6080f6b5dbf82cac6ce75c}} 
\index{go\_to\_point.py@{go\_to\_point.py}!position\_@{position\_}}
\index{position\_@{position\_}!go\_to\_point.py@{go\_to\_point.py}}
\doxysubsubsection{\texorpdfstring{position\_}{position\_}}
{\footnotesize\ttfamily int go\+\_\+to\+\_\+point.\+position\+\_\+ = Point()}



Point to store the actual position. 

position of the robot initialized to 0 