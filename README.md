# First Assignment of the Research Track 2 course (action branch), Alessio Roda 4458313

The purpose of this package is to create a simulation in wich the robot follows some random positions generated by the a random server and reach it.
The robot can also stop if user orde it, but oly when it arrives in the last position that had to reach.
In this branch respect to the main branch, the files "state_machine.cpp" and "position_service.cpp" are implemented as ROS2 component and the general architecture is divided in two parts: one devleopped with ROS2 component and the other one develloped by mantainig the scripts of the main branch in ROS1.
So by considering this, in order to run the code there will be an interaction between ROS1 and ROS2 that can be possible thanks to a "ros bridge", if you haven't installed it yet you can fin the guide to download and install here: https://github.com/ros2/ros1_bridge.

Before start remembre to download the rt2_assignment1 in your ros workspace, since as said before it's necessary in order to run the code. 

## Description of the architecture
 
 The code here was developped for ros2 foxy, so make sure that you have this distribution in your computer before start. This part of the architecture is based on two components:
 
 1) random_position_server generate a random position and send it with RandomPosition custom service message.
 2) state_machine is the "main" of the architecture: it gets the commad custom service message and if it's "start", it publish the position the robot has to reach by setting the coordinates it takes from the RandomPosition custom service message. Then it checks if user wants to stop the robot and in case stop sending random positions to reach.
 
 In this package there are four folders:
 
 * launch
 * src
 * srv
 * urdf

There is also a docs folder wich contains a deeper documentation about the code, please have a look to it to understand in detail what every code do, here below there's a more "superficial" description about what the folders contains and what is changed respect to the main branch.

 
The "launch" one contains two launch files 

 * ros2_sim.py
 
 which is the launch files to run the simulation with gazeebo. The file provides to load the components in the rt2_assignment1 container.

In "src" there are the "position_service.cpp" and "state_machine.cpp" codes, the first one is tha same as in main branch, while "state_machine.cpp" was modified in order to istanciate the postion that the robot has to reach as an action goal, so once the goal is created and configured with the same parameters as Position.srv in main branch had (x, y, theta) it's send to the "/go_to_point.py" node. Then the "/state_machine" node execute an infinite loop in wich it verifies that the user has cancelled the goal and in this case provides to delate the goal and set the linear and angular velcity of the robot to zero in order to stop it.

The "srv" folder contains the Command.srv and RandomPosition.srv files wich contains the information for the message respectively for the command that the user provides in the "/user_interface" node, and the position that robot has to reach provided by the "/random_position_server" node.

Finally "urdf" is a folder wich contains the description of the robot we are using in the simulation.

In the package there's also the "coppeliaScene.ttt" scene, wich has to be laded in Coppelia simulator in order to see the Coppelia simulation.


## Behaviour of the architecture
